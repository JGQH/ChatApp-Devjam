var A=Object.defineProperty,D=Object.defineProperties;var k=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var w=(n,r,a)=>r in n?A(n,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[r]=a,m=(n,r)=>{for(var a in r||(r={}))S.call(r,a)&&w(n,a,r[a]);if(E)for(var a of E(r))F.call(r,a)&&w(n,a,r[a]);return n},h=(n,r)=>D(n,k(r));var y=(n,r)=>{var a={};for(var s in n)S.call(n,s)&&r.indexOf(s)<0&&(a[s]=n[s]);if(n!=null&&E)for(var s of E(n))r.indexOf(s)<0&&F.call(n,s)&&(a[s]=n[s]);return a};import{R as e,b as _,A as O,r as c,a as j}from"./vendor.3ef63d80.js";const L=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const l of t)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function a(t){const l={};return t.integrity&&(l.integrity=t.integrity),t.referrerpolicy&&(l.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?l.credentials="include":t.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(t){if(t.ep)return;t.ep=!0;const l=a(t);fetch(t.href,l)}};L();const I="_element_l2ap8_1";var M={element:I};function b(s){var t=s,{className:n,children:r}=t,a=y(t,["className","children"]);const l=[...n||[],M.element].join(" ");return e.createElement("button",m({className:l},a),r)}const P="_element_13hkc_1";var R={element:P};function N(a){var s=a,{className:n}=s,r=y(s,["className"]);const t=[...n||[],R.element].join(" ");return e.createElement("input",m({className:t},r))}const B=["https://gdb.jgq.repl.co/gun"],x=_({peers:B}),q=x.user().recall({sessionStorage:!0}),d=O.default(x),$=c.exports.createContext({});function p(){return c.exports.useContext($)}function G({children:n}){const[r,a]=c.exports.useState(void 0),[s,t]=c.exports.useState({loading:!1});function l(g,f){t({loading:!0}),d.create({alias:g,pass:f}).then(()=>{t({loading:!1})}).catch(v=>{t({loading:!1,error:v.message})})}function o(g,f){t({loading:!0}),d.login({alias:g,pass:f}).then(()=>{t({loading:!1})}).catch(v=>{t({loading:!1,error:v.message})})}function i(){d.logout(),a(void 0)}return c.exports.useEffect(()=>(d.on(()=>{d.user().get("alias").once(f=>a(f))}),()=>{d.off()}),[]),e.createElement($.Provider,{value:{db:x,user:q,username:r,state:s,signUp:l,signIn:o,signOut:i}},n)}const T="_container_1hvbs_1";var z={container:T};const H="d707731b-fa75-49de-91b6-fbb203eab4f9";function K(){const{db:n,user:r}=p(),[a,s]=c.exports.useState("");async function t(){const l=await _.SEA.encrypt(a,H),o=r.get("all").set({content:l}),i=Date.now().toString();n.get("general").get(i).put(o),s("")}return e.createElement("div",{className:z.container},e.createElement(N,{type:"text",placeholder:"Type your message here...",onChange:l=>s(l.target.value),value:a}),e.createElement(b,{onClick:t,disabled:a.length===0},"Send"))}function Y(){const[n,r]=c.exports.useState({});function a(s,t){const l=h(m({},n),{[s]:t});r(l)}return[n,a]}const J="_container_f1467_1",Q="_title_f1467_1",V="_form_f1467_8",W="_inputField_f1467_12",X="_errorField_f1467_19",Z="_buttonField_f1467_24";var u={container:J,title:Q,form:V,inputField:W,errorField:X,buttonField:Z};function ee(){const[{alias:n,pass:r},a]=Y(),{state:{loading:s,error:t},signIn:l,signUp:o}=p();return e.createElement("div",{className:u.container},e.createElement("div",{className:u.title},e.createElement("h1",null,"Devjam Chat")),e.createElement("div",{className:u.form},e.createElement("div",{className:u.inputField},e.createElement("p",null,"Username:"),e.createElement(N,{type:"text",placeholder:"Example: Devjam",onChange:i=>a("alias",i.target.value)})),e.createElement("div",{className:u.inputField},e.createElement("p",null,"Password:"),e.createElement(N,{type:"password",placeholder:"Example: Devjam-App",onChange:i=>a("pass",i.target.value)})),e.createElement("div",{className:u.buttonField},e.createElement(b,{onClick:()=>l(n,r),disabled:s},"Sign In"),e.createElement(b,{onClick:()=>o(n,r),disabled:s},"Sign Up")),t&&e.createElement("div",{className:u.errorField},e.createElement("p",null,"Error: ",t))))}const te="_container_14gz9_1";var ne={container:te};const re="_container_nplcm_1",ae="_username_nplcm_18";var U={container:re,username:ae};function se(){const{username:n,signOut:r}=p();return e.createElement("div",{className:U.container},e.createElement("button",null,e.createElement("p",null,"Channel:"),e.createElement("h3",null,"#general")),e.createElement("div",{className:U.username},e.createElement("h1",null,n)),e.createElement("button",{onClick:r},e.createElement("p",null,"Sign Out")))}const le="_container_1src4_1",oe="_message_1src4_8",ce="_identifier_1src4_12";var C={container:le,message:oe,identifier:ce};function ie({alias:n,content:r,time:a,isUser:s}){const t=new Date(a).toLocaleString();return e.createElement("div",{className:C.message},e.createElement("div",{className:C.identifier},e.createElement("h3",null,n),e.createElement("h6",null,"\u2800",t),s&&e.createElement("h6",null,"\u2800(You)")),e.createElement("div",null,e.createElement("p",null,r)))}const ue="d707731b-fa75-49de-91b6-fbb203eab4f9";function me(){const{db:n,username:r}=p(),[a,s]=c.exports.useState([]);return c.exports.useEffect(()=>(n.get("general").map().once(async t=>{if(t){const l={alias:await n.user(t).get("alias"),content:await _.SEA.decrypt(t.content,ue),time:+_.state.is(t,"content")};l.content&&s(o=>[...o.slice(-100),l])}}),()=>n.off()),[]),e.createElement("div",{className:C.container},a.sort((t,l)=>t.time-l.time).map((t,l)=>{const o=t.alias===r;return e.createElement(ie,m({},h(m({},t),{isUser:o,key:l})))}))}function de(){const{username:n}=p();return e.createElement("div",{className:ne.container},n?e.createElement(e.Fragment,null,e.createElement(se,null),e.createElement(me,null),e.createElement(K,null)):e.createElement(ee,null))}function fe(){return e.createElement(G,null,e.createElement(de,null))}j.render(e.createElement(e.StrictMode,null,e.createElement(fe,null)),document.getElementById("root"));
